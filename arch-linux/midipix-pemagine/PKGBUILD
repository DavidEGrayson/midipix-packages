# Maintainer: David Grayson <davidegrayson@gmail.com>

_target=x86_64-nt64-midipix

pkgname=$_target-pemagine
conflicts=($_target-psxscl)
pkgver=r32.434ff49
pkgrel=1
pkgdesc=""
arch=('any')
url="http://git.midipix.org/$midipix_internal/pemagine"
license=('unknown')
makedepends=($_target-gcc)
options=(!strip)
source=("git://midipix.org/$midipix_internal/pemagine")
sha256sums=('SKIP')

pkgver() {
  cd "${srcdir}/pemagine"
  printf "r%s.%s" "$(git rev-list --count HEAD)" "$(git rev-parse --short HEAD)"
}

build() {
  # Override Arch Linux compile flags (which are not recognized
  # by our toolchain) with our own.
  export CFLAGS="-g3 -O0"  # easy debugging for now
  export LDFLAGS=""

  cd "${srcdir}/pemagine"
  ../pemagine/configure --debug --host="$_target"
}

package() {
  cd "${srcdir}/pemagine"
  make DESTDIR="${pkgdir}/usr/${_target}" install
}
