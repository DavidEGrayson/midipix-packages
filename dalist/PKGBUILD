pkgname=dalist
pkgver=r23.bb4eb7e
pkgrel=1
pkgdesc='A zero-dependency book-keeping library.'
arch=('midipix64')
url='http://git.midipix.org/cgit.cgi/${midipix_internal}/${pkgname}'
license=('GPLv2' 'GPLv3')
depends=()
if [ -z "$CROSS" ]; then
  makedepends=('psxtypes')
else
  echo "This depends on psxtypes at build time. So if you are cross-compiling: "
  echo "  cd /path/to/x86_64-nt64-midipix"
  echo "  tar --exclude='.*' -xf /path/to/psxtypes-r6.4d71ed8-1-midipix64.pkg.tar.xz"
fi
checkdepends=()
optdepends=()
source=("git://midipix.org/${midipix_internal}/${pkgname}")
sha256sums=('SKIP')

pkgver() {
  cd "${srcdir}/${pkgname}"
  printf "r%s.%s" "$(git rev-list --count HEAD)" "$(git rev-parse --short HEAD)"
}

build() {
  rm -rf "build-${CHOST}"
  mkdir "build-${CHOST}"
  cd "build-${CHOST}"
  "${srcdir}/${pkgname}/configure" --debug --host="${CHOST}"
  make
}

package() {
  cd "${srcdir}/build-${CHOST}"
  make DESTDIR="${pkgdir}" install

  # TODO: install license too
}
